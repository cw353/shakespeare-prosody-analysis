

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Prosodical Analysis of Shakespearean Sonnets &#8212; Claire Wagner: ENGL 495 Report</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'report';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    <p class="title logo__title">Claire Wagner: ENGL 495 Report</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Prosodical Analysis of Shakespearean Sonnets
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/report.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Prosodical Analysis of Shakespearean Sonnets</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scraping-the-corpus">Scraping the Corpus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correcting-the-corpus">Correcting the Corpus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-correction">Manual Correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-correction">Automatic Correction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-and-scanning-the-corpus">Parsing and Scanning the Corpus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#division-into-metrical-feet">Division into Metrical Feet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tokenization">Tokenization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syllabification">Syllabification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scansion">Scansion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-the-corpus">Analyzing the Corpus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#foot-types-per-index">Foot Types per Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irregularities-per-line-number">Irregularities per Line Number</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consecutive-feet">Consecutive Feet</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="prosodical-analysis-of-shakespearean-sonnets">
<h1><a class="toc-backref" href="#id1">Prosodical Analysis of Shakespearean Sonnets</a><a class="headerlink" href="#prosodical-analysis-of-shakespearean-sonnets" title="Permalink to this heading">#</a></h1>
<section id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The objective of this project is to detect and investigate metrical irregularities and other prosodic patterns in English verse, using both manual and computational methods of analysis. By investigating these patterns, we can achieve a better understanding of how they contribute to the poetry’s effect.</p>
<p>As a case study, I will analyze the corpus of William Shakespeare’s sonnets. As one of the greatest poets in the English language, Shakespeare composes poetry with a subtlety, eloquence, and mastery that make his sonnet corpus a fitting subject for study.</p>
<p>In this report, I will first detail my process of scraping and correcting the corpus of Shakespeare’s sonnets. Then I will explain how I parsed and scanned the corpus to encode it into a form that is more efficient and convenient for analysis. Finally, I will give some examples of the sorts of analysis that can be done on this corpus.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#prosodical-analysis-of-shakespearean-sonnets" id="id1">Prosodical Analysis of Shakespearean Sonnets</a></p>
<ul>
<li><p><a class="reference internal" href="#introduction" id="id2">Introduction</a></p></li>
<li><p><a class="reference internal" href="#initial-setup" id="id3">Initial Setup</a></p></li>
<li><p><a class="reference internal" href="#scraping-the-corpus" id="id4">Scraping the Corpus</a></p></li>
<li><p><a class="reference internal" href="#correcting-the-corpus" id="id5">Correcting the Corpus</a></p>
<ul>
<li><p><a class="reference internal" href="#manual-correction" id="id6">Manual Correction</a></p></li>
<li><p><a class="reference internal" href="#automatic-correction" id="id7">Automatic Correction</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#parsing-and-scanning-the-corpus" id="id8">Parsing and Scanning the Corpus</a></p>
<ul>
<li><p><a class="reference internal" href="#division-into-metrical-feet" id="id9">Division into Metrical Feet</a></p></li>
<li><p><a class="reference internal" href="#tokenization" id="id10">Tokenization</a></p></li>
<li><p><a class="reference internal" href="#syllabification" id="id11">Syllabification</a></p></li>
<li><p><a class="reference internal" href="#scansion" id="id12">Scansion</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#analyzing-the-corpus" id="id13">Analyzing the Corpus</a></p>
<ul>
<li><p><a class="reference internal" href="#setup" id="id14">Setup</a></p></li>
<li><p><a class="reference internal" href="#foot-types-per-index" id="id15">Foot Types per Index</a></p></li>
<li><p><a class="reference internal" href="#irregularities-per-line-number" id="id16">Irregularities per Line Number</a></p></li>
<li><p><a class="reference internal" href="#consecutive-feet" id="id17">Consecutive Feet</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#conclusion" id="id18">Conclusion</a></p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="initial-setup">
<h2><a class="toc-backref" href="#id3">Initial Setup</a><a class="headerlink" href="#initial-setup" title="Permalink to this heading">#</a></h2>
<p>We begin by importing various Python libraries that will be used in this project:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for web scraping</span>
<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="c1"># for data encoding, manipulation, and display</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">IntFlag</span><span class="p">,</span> <span class="n">auto</span>

<span class="c1"># for pattern matching</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># for syllabification</span>
<span class="kn">from</span> <span class="nn">eng_syl.syllabify</span> <span class="kn">import</span> <span class="n">Syllabel</span>

<span class="c1"># for visualization</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chisquare</span><span class="p">,</span> <span class="n">chi2_contingency</span><span class="p">,</span> <span class="n">binomtest</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
</pre></div>
</div>
</div>
</div>
<p>We also define some constants that will be used throughout the project:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">14</span> <span class="c1"># maximum number of lines in a sonnet</span>
<span class="n">wordchars</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([a-zA-Z</span><span class="se">\&#39;</span><span class="s1">]+)&#39;</span><span class="p">)</span> <span class="c1"># regular expression defining word characters</span>
<span class="n">nonwordchars</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([^a-zA-Z</span><span class="se">\&#39;</span><span class="s1">]+)&#39;</span><span class="p">)</span> <span class="c1"># regular expression defining non-word characters</span>
<span class="n">syllabifier</span> <span class="o">=</span> <span class="n">Syllabel</span><span class="p">()</span> <span class="c1"># syllabifier used to split word tokens into component syllables</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="scraping-the-corpus">
<h2><a class="toc-backref" href="#id4">Scraping the Corpus</a><a class="headerlink" href="#scraping-the-corpus" title="Permalink to this heading">#</a></h2>
<p>The raw corpus of scanned sonnets was obtained from <a class="reference external" href="http://prescannedshakespeare.aruffo.com/">Chris Aruffo’s Prescanned Shakespeare project</a> and is used with the creator’s kind permission. This corpus presented itself as ideal for this project because it already contains scansion information for all 154 sonnets.</p>
<p>According to <a class="reference external" href="http://prescannedshakespeare.aruffo.com/about/scansion.htm">Aruffo’s website</a>, the corpus text is “based primarily on the First Folio and its punctuation.” The spelling of all words is modernized except for “ore”, “ere”, “nere”, “eene”, and “tane”, which represent monosyllabic equivalents of “over”, “ever”, “never”, “even”, and “taken”.</p>
<p>Both conceptually and structurally, we divide the corpus into <code class="docutils literal notranslate"><span class="pre">text</span></code> data, representing the actual text of the sonnets, and <code class="docutils literal notranslate"><span class="pre">scansion</span></code> data, representing the corresponding scansion information.</p>
<p>We define some functions that we will use to scrape the sonnets from the web and do some preprocessing:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get all urls to scrape</span>
<span class="k">def</span> <span class="nf">get_urls</span><span class="p">():</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pref</span> <span class="o">=</span> <span class="s1">&#39;http://prescannedshakespeare.aruffo.com/sonnets&#39;</span>
    <span class="n">max_sonnet</span> <span class="o">=</span> <span class="mi">154</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">15</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">15</span> <span class="o">+</span> <span class="mi">15</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="n">max_sonnet</span>    
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">15</span> <span class="ow">and</span> <span class="n">start</span><span class="o">+</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">max_sonnet</span><span class="p">:</span>
            <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pref</span><span class="si">}</span><span class="s1">/son</span><span class="si">{</span><span class="n">start</span><span class="si">:</span><span class="s1">0&gt;3</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">end</span><span class="si">:</span><span class="s1">0&gt;3</span><span class="si">}</span><span class="s1">/son</span><span class="si">{</span><span class="n">start</span><span class="o">+</span><span class="n">j</span><span class="si">:</span><span class="s1">0&gt;3</span><span class="si">}</span><span class="s1">.htm&#39;</span><span class="p">)</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">urls</span>

<span class="c1"># process HTML page and extract the text and scansion of the sonnet therein</span>
<span class="k">def</span> <span class="nf">process_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
    <span class="c1"># find p element containing the sonnet</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">p</span>
    <span class="k">while</span> <span class="n">p</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">&#39;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">find_next</span><span class="p">()</span>
    <span class="n">contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">contents</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">text</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">scansions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># extract a max of N lines each of scansion and text data from html</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">contents</span><span class="p">),</span> <span class="n">N</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">2</span> == 0:
            <span class="n">scansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)[</span><span class="mi">6</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contents</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="s1">&#39;//&#39;</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;|&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;??&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()[</span><span class="mi">6</span><span class="p">:])</span>
    <span class="c1"># remove any extraneous data</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
    <span class="n">scansions</span> <span class="o">=</span> <span class="n">scansions</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">texts</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">texts</span> <span class="o">=</span> <span class="n">texts</span><span class="p">[:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">scansions</span> <span class="o">=</span> <span class="n">scansions</span><span class="p">[:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">scansions</span><span class="p">)</span>

<span class="c1"># read foot divisions from text data and mark them in the scansion data</span>
<span class="k">def</span> <span class="nf">mark_feet</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">scansions</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)</span>
    <span class="c1"># add foot marks to scansions</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;|&#39;</span><span class="p">:</span>
                <span class="n">scansions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">scansions</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">c</span> <span class="o">+</span> <span class="n">scansions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="c1"># remove extra spaces around foot marks</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39; \| &#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">texts</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">-</span><span class="n">k</span>
            <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">texts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">texts</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">texts</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">scansions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">scansions</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">scansions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">scansions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Using these functions, we read each sonnet from the web and split it into <code class="docutils literal notranslate"><span class="pre">texts</span></code> (the actual text of the poem) and <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code> (the raw marks indicating how the poem should be scanned).</p>
<p>Although the text of the sonnets includes marks indicating division into feet, the scansion does not. We remedy this situation by copying the foot division marks from the text to the scansion.</p>
<p>Finally, we save the raw text and scansion data for each sonnet into a file called <code class="docutils literal notranslate"><span class="pre">sonnets-original.txt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">urls</span> <span class="o">=</span> <span class="n">get_urls</span><span class="p">()</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/sonnets-original.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">url</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
        <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">raw_scansion</span><span class="p">)</span> <span class="o">=</span> <span class="n">process_html</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">raw_scansion</span><span class="p">)</span> <span class="o">=</span> <span class="n">mark_feet</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">raw_scansion</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raw_scansion</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then read the corpus from <code class="docutils literal notranslate"><span class="pre">sonnets-original.txt</span></code> into the variables <code class="docutils literal notranslate"><span class="pre">texts</span></code> and <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/sonnets-original.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">raw_scansions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sonnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">raw_scansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This diagram illustrates the current structure of the corpus, before any corrections or parsing have been done. Note how the structure is essentially a two-dimensional array, or a list of lists. Each list is annotated with its length, denoted with the variable <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p><img alt="" src="_images/diagram_texts_preparse.png" /></p>
<p>As this diagram shows, <code class="docutils literal notranslate"><span class="pre">texts</span></code> is a list of 154 sonnets. Each sonnet is itself a list of 14 lines, and each line is a string. (The vertical bar <code class="docutils literal notranslate"><span class="pre">|</span></code> marks foot divisions.)</p>
<p><code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code> has a structure identical to this except that its lowest level consists not of lines but rather of custom scan marks encoding scansion information for the lines in <code class="docutils literal notranslate"><span class="pre">texts</span></code>. These scan marks are aligned with the corresponding text by whitespace. For example, the alternating scansion and text data for the first quatrain of Sonnet 18 looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sc</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">raw_scansions</span><span class="p">[</span><span class="mi">17</span><span class="p">][:</span><span class="mi">4</span><span class="p">],</span> <span class="n">texts</span><span class="p">[</span><span class="mi">17</span><span class="p">][:</span><span class="mi">4</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sc</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ,    |     ,  |   ,    |    , |       ,
Shall I| compare| thee to| a sum|mer&#39;s day?
  ,     |   ,    , |      |   ,    ,|
Thou art| more love|ly and| more temp|erate:
  T     T    .    T |        ,|       ,|      ,
Rough winds do shake| the darl|ing buds| of May,
     , |         , |       , |  T    T   .   T
And sum|mer&#39;s lease| hath all| too short a date:
</pre></div>
</div>
</div>
</div>
</section>
<section id="correcting-the-corpus">
<h2><a class="toc-backref" href="#id5">Correcting the Corpus</a><a class="headerlink" href="#correcting-the-corpus" title="Permalink to this heading">#</a></h2>
<p>The raw scan marks in <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code> will provide the basis for the scansion of the fully parsed corpus. However, they still need to be corrected both manually and automatically, as well as encoded into a more computationally useful format. The following sections detail this process.</p>
<section id="manual-correction">
<h3><a class="toc-backref" href="#id6">Manual Correction</a><a class="headerlink" href="#manual-correction" title="Permalink to this heading">#</a></h3>
<p>The scansion of Aruffo’s raw corpus is based on a theory of mathematically equal feet, inspired by a similar approach taken by Edgar Allan Poe. Aruffo explains this theory in the article <a class="reference external" href="https://doi.org/10.1111/j.1754-6095.2011.00037.x">“Reconsidering Poe’s ‘Rationale of Verse’”</a>. Essentially, the theory holds that any line of metrically valid poetry can be scanned into a number of feet that are quantitatively equal in time.</p>
<p>Although Aruffo’s theory of prosody is intriguing, I have decided not to use it in this project. Instead, I have opted to follow a more traditional scansion scheme. Since the scan marks in the raw corpus are based on Aruffo’s theory, I have applied a series of manual corrections to make the corpus conform more closely to traditional scansion.</p>
<p>The original scansion data uses several different marks to denote stressed syllables: <code class="docutils literal notranslate"><span class="pre">,</span></code>, <code class="docutils literal notranslate"><span class="pre">_</span></code>, <code class="docutils literal notranslate"><span class="pre">x</span></code>, and <code class="docutils literal notranslate"><span class="pre">T</span></code>. Aruffo <a class="reference external" href="http://prescannedshakespeare.aruffo.com/about/marks.htm">defines these marks</a> as follows:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Mark</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>,</p></td>
<td><p>long syllable</p></td>
</tr>
<tr class="row-odd"><td><p>_</p></td>
<td><p>extended, extra-long syllable</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>short stress (where two short syllables create a single stress)</p></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>syllable that is part of a double foot (made up of three long feet)</p></td>
</tr>
</tbody>
</table>
<p>All of these marks have been manually standardized into a single stress mark, <code class="docutils literal notranslate"><span class="pre">,</span></code>. Additionally, unusually short or long feet, which are often associated with these marks, have been redistributed into more standard foot divisions. To assist with this task, I consulted <a class="reference external" href="https://doi.org/10.1093/acref/9780199668427.001.0001"><em>The Oxford Dictionary of Shakespearean Pronunciation</em> by David Crystal</a> to gain a better idea of how the lines would be pronounced and scanned in their original context.</p>
<p>Finally, the placement of a few of the scan marks has been standardized to make automatic parsing easier, and a few extraneous scan marks have been removed.</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">sonnets-handcorrected.txt</span></code> contains this manually corrected version of the corpus. We read this hand-corrected version into the variables <code class="docutils literal notranslate"><span class="pre">text</span></code> and <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code> (after saving copies of the original text and raw scansion data).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save original scansion and text data</span>
<span class="p">(</span><span class="n">original_raw_scansions</span><span class="p">,</span> <span class="n">original_texts</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">raw_scansions</span><span class="p">,</span> <span class="n">texts</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/sonnets-handcorrected.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">raw_scansions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sonnet</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">raw_scansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As an example of the manual corrections that have been now been made to the corpus, here is a side-by-side comparison of the original and hand-corrected versions of Sonnet 18. Note how the stress marks and foot divisions have been standardized.</p>
<div class="cell tag_full-width docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ORIGINAL VERSION&#39;</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;HAND-CORRECTED VERSION&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sc1</span><span class="p">,</span> <span class="n">sc2</span><span class="p">,</span> <span class="n">line1</span><span class="p">,</span> <span class="n">line2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">original_raw_scansions</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">raw_scansions</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">original_texts</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">texts</span><span class="p">[</span><span class="mi">17</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sc1</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sc2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line1</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ORIGINAL VERSION                                       		HAND-CORRECTED VERSION

  ,    |     ,  |   ,    |    , |       ,              		  ,    |     ,  |   ,    |    , |       ,
Shall I| compare| thee to| a sum|mer&#39;s day?            		Shall I| compare| thee to| a sum|mer&#39;s day?
  ,     |   ,    , |      |   ,    ,|                  		  ,     |   ,    , |      |   ,    ,|
Thou art| more love|ly and| more temp|erate:           		Thou art| more love|ly and| more temp|erate:
  T     T    .    T |        ,|       ,|      ,        		  ,     ,  |       , |        ,|       ,|      ,
Rough winds do shake| the darl|ing buds| of May,       		Rough winds| do shake| the darl|ing buds| of May,
     , |         , |       , |  T    T   .   T         		     , |         , |       , |  ,    ,  |     ,
And sum|mer&#39;s lease| hath all| too short a date:       		And sum|mer&#39;s lease| hath all| too short| a date:
  T   T   T |  ,     |  T   .   Tx      T              		  ,   , |  ,   , |      , |  .   ,|       ,
Sometime too| hot the| eye of heaven shines,           		Sometime| too hot| the eye| of hea|ven shines,
     ,|     ,|       , |      , |       ,              		     ,|     ,|       , |      , |       ,
And of|ten is| his gold| complex|ion dimmed,           		And of|ten is| his gold| complex|ion dimmed,
     , |     , |         ,|    T   T   .   T           		     , |     , |         ,|    ,   ,|      ,
And eve|ry fair| from fair| sometime  declines,        		And eve|ry fair| from fair| sometime| declines,
      ,   |     ,|         ,  |       ,  |      ,      		      ,   |     ,|         ,  |       ,  |      ,
By chance,| or na|ture&#39;s chang|ing course| untrimmed:  		By chance,| or na|ture&#39;s chang|ing course| untrimmed:
     , |    , |      x  |   T    T    T                		     , |    , |    , |      ,  |  ,    ,
But thy| etern|al summer| shall not fade,              		But thy| etern|al sum|mer shall| not fade,
      , |      , |     ,|        , |        ,          		      , |      , |     ,|        , |        ,
Nor lose| possess|ion of| that fair| thou owst,        		Nor lose| possess|ion of| that fair| thou owst,
       , |    T    T     T|    ,    |    2      ,      		       , |    ,    , |    ,   , |       |        ,
Nor shall| death brag thou| wanderst| in his shade,    		Nor shall| death brag| thou wand|erst in| his shade,
      ,|    , |     ,  |      , |         ,            		      ,|    , |     ,  |      , |         ,
When in| etern|al lines| to time| thou growst,         		When in| etern|al lines| to time| thou growst,
     , |     , |        ,    |      , |      ,         		     , |     , |        ,    |      , |      ,
So long| as men| can breathe,| or eyes| can see,       		So long| as men| can breathe,| or eyes| can see,
 .   T    T     T  |  .    T    T     T |      ,       		     , |   ,     ,  |       , |   ,     , |      ,
So long lives this,| and this gives life| to thee.     		So long| lives this,| and this| gives life| to thee.
</pre></div>
</div>
</div>
</div>
</section>
<section id="automatic-correction">
<h3><a class="toc-backref" href="#id7">Automatic Correction</a><a class="headerlink" href="#automatic-correction" title="Permalink to this heading">#</a></h3>
<p>The next step is to make automatic corrections – corrections that can be applied computationally by using algorithms and pattern matching — to the scansion corpus.</p>
<p>The reason that algorithmic corrections are necessary is because of a concept that I refer to as <em>prosodical flexibility</em>. In English (and especially in Shakespearean English), certain morphological units can be scanned in different ways depending on the constraints of the meter. For example, consider the word “buried” in Sonnet 31:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="mi">30</span><span class="p">]):</span>
    <span class="k">if</span> <span class="s1">&#39;buried&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Line 4: And all| those friends| which I| thought bur|ied.
Line 9: Thou art| the grave| where bur|ied love| doth live,
</pre></div>
</div>
</div>
</div>
<p>In line 4, the constraints of the meter encourage us to pronounce the past participle ending “-ed” in the word “buried” as a separate syllable (so the entire word is scanned as three syllables, “bur-i-ed”). In line 9, on the other hand, the “-ed” ending is not pronounced as a separate syllable (so the entire word is scanned as two syllables, “bur-ied”).</p>
<p>This past participle ending is thus an example of a morphological unit that is prosodically flexible. Depending on how the rest of the line is scanned, a prosodically flexible unit can either be pronounced as a separate syllable or collapsed into the preceding or following syllables.</p>
<p>As another example, consider the word “heaven” in Sonnet 21:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="mi">20</span><span class="p">]):</span>
    <span class="k">if</span> <span class="s1">&#39;heaven&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Line </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Line 3: Who heaven| itself| for orn|ament| doth use
Line 8: That heav|en&#39;s air| in this| huge rond|ure hems.
Line 12: As those| gold cand|les fixed| in heav|en&#39;s air:
</pre></div>
</div>
</div>
</div>
<p>In line 3, the word “heaven” is compressed into a single syllable, while in lines 8 and 12, it takes up two syllables. The word “heaven” is thus also prosodically flexible.</p>
<p>These prosodically flexible units are not always marked as such in the raw scansion data. But marking them all by hand would be both inefficient and error-prone. As a result, this is an ideal opportunity to apply automatic correction.</p>
<p>We can use regular expressions — specialized expressions used for pattern matching in strings — to identify patterns of characters that are likely to be prosodically flexible. Then we can add a special scan mark, <code class="docutils literal notranslate"><span class="pre">?</span></code>, to the scansion data for all instances of these patterns to mark them as prosodically flexible. Specifically, this mark will be used to annotate units that can be pronounced as zero or one syllables. In the code, these are referred to as <code class="docutils literal notranslate"><span class="pre">flex_minus</span></code> syllables (because they can be subtracted from the total syllable count as necessary).</p>
<p>Slightly complicating the situation, however, is the fact that we will be using a machine learning model to break apart words (or parts of words) into syllables. This syllabifier does not always recognize prosodically flexible units as separate syllables. For example, the model syllabifies the ending “-ied” into a single syllable rather than two:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">syllabifier</span><span class="o">.</span><span class="n">syllabify</span><span class="p">(</span><span class="s1">&#39;ied&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ied&#39;
</pre></div>
</div>
</div>
</div>
<p>We cannot simply mark such cases as <code class="docutils literal notranslate"><span class="pre">flex_minus</span></code>. Instead, we will treat them as a separate category of prosodically flexible units that can be pronounced as either one or two syllables. These units will be marked with the symbol <code class="docutils literal notranslate"><span class="pre">+</span></code> and referred to as <code class="docutils literal notranslate"><span class="pre">flex_plus</span></code> in the code (because they can be added to the total syllable count if necessary).</p>
<p>We begin by defining regular expressions for the <code class="docutils literal notranslate"><span class="pre">flex_minus</span></code> and <code class="docutils literal notranslate"><span class="pre">flex_plus</span></code> categories, as well as a function to apply the annotation. For this step, as with the previous one, <em>The Oxford Dictionary of Shakespearean Pronunciation</em> served as a valuable reference.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># handle syllables with flexible stress (that is, syllables that can be</span>
<span class="c1"># pronounced separately or collapsed into each other depending on the meter)</span>
<span class="c1"># (note that we need to specify two offsets so that, if there is already a</span>
<span class="c1"># scan mark at the first offset, we can place the new mark at the second offset)</span>

<span class="c1"># regex for patterns that tend to be syllabified as multiple syllables but can be collapsed together</span>
<span class="c1"># along with two offsets, either of which can be used to mark these syllables as flexible</span>
<span class="n">flex_minus</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;uels?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ials?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;iars?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ires?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ians?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;iest\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ient?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ienc[ey]\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ying\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;eous\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;iousl?y?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;uous\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;oners?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erers?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;owers?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ours?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ions?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;uals?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ually\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;iers?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;iors?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ery\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erims?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erent\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erances?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ewels?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;ayers?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erous\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erously\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;erate\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;e[rn]ings?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;o[rn]ings?\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;iven\b&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\beven\b&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\bbeing\b&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\bcreat\|?ure&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\bheaven&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\bspirit\b&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\btowards?\b&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\bthe\s[aeiou]&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\bis it\b&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># regex for patterns that tend not to be syllabified as separate but can be expanded into a separate syllable</span>
<span class="c1"># along with two offsets, either of which can be used to mark these syllables as flexible</span>
<span class="n">flex_plus</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[abcdfghijklmnopqrstuvwxyz]ed\b&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">mark_flex</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">scanmarks</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">marker</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">first_offset</span><span class="p">,</span> <span class="n">second_offset</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">patterns</span><span class="p">):</span>
        <span class="n">it</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">rslen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scanmarks</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rslen</span> <span class="o">&lt;=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">second_offset</span><span class="p">:</span>
                <span class="n">scanmarks</span> <span class="o">=</span> <span class="n">scanmarks</span> <span class="o">+</span> <span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">second_offset</span> <span class="o">-</span> <span class="n">rslen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">scanmarks</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="n">first_offset</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">first_offset</span>
            <span class="k">elif</span> <span class="n">scanmarks</span><span class="p">[</span><span class="n">start</span> <span class="o">+</span> <span class="n">second_offset</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="n">second_offset</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">offset</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;error: neither offset is available for line&#39;</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scanmarks</span> <span class="o">=</span> <span class="n">scanmarks</span><span class="p">[:(</span><span class="n">start</span> <span class="o">+</span> <span class="n">offset</span><span class="p">)]</span> <span class="o">+</span> <span class="n">marker</span> <span class="o">+</span> <span class="n">scanmarks</span><span class="p">[(</span><span class="n">start</span> <span class="o">+</span> <span class="n">offset</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):]</span>
    <span class="k">return</span> <span class="n">scanmarks</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>Next, we perform the actual annotation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mark the scansion for each flexible syllable with &#39;?&#39;</span>
<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">texts</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sonnet</span><span class="p">):</span>
        <span class="n">raw_scansions</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">mark_flex</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">flex_minus</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span>
        <span class="n">raw_scansions</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">mark_flex</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">l</span><span class="p">],</span> <span class="n">flex_plus</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we save this automatically corrected version of the corpus to another file, called <code class="docutils literal notranslate"><span class="pre">sonnets-autocorrected.txt</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/sonnets-autocorrected.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="n">s</span><span class="p">])):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raw_scansions</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">l</span><span class="p">])</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">l</span><span class="p">])</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="parsing-and-scanning-the-corpus">
<h2><a class="toc-backref" href="#id8">Parsing and Scanning the Corpus</a><a class="headerlink" href="#parsing-and-scanning-the-corpus" title="Permalink to this heading">#</a></h2>
<p>Now that we have finished correcting the corpus, we can begin the process of parsing and scanning it into a form that will be more convenient and efficient to work with.</p>
<section id="division-into-metrical-feet">
<h3><a class="toc-backref" href="#id9">Division into Metrical Feet</a><a class="headerlink" href="#division-into-metrical-feet" title="Permalink to this heading">#</a></h3>
<p>Our first step is to split <code class="docutils literal notranslate"><span class="pre">text</span></code> and <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code> apart into metrical feet using the following function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">split_feet</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">scansions</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="p">[[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">]</span> <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">],</span>
        <span class="p">[[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">]</span> <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">scansions</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">)</span> <span class="o">=</span> <span class="n">split_feet</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The two-dimensional <code class="docutils literal notranslate"><span class="pre">texts</span></code> and <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code> arrays have now become three-dimensional, since each line is now a list of feet. The corpus is now a list of 154 sonnets, each of which is a list of 14 lines, each of which is a list of 4 or 5 feet, each of which is a string. (The number of feet is variable because Sonnet 145 is in tetrameter.)</p>
<p>The diagram below illustrates this updated corpus structure for <code class="docutils literal notranslate"><span class="pre">texts</span></code>.</p>
<p><img alt="" src="_images/diagram_texts_feet.png" /></p>
</section>
<section id="tokenization">
<h3><a class="toc-backref" href="#id10">Tokenization</a><a class="headerlink" href="#tokenization" title="Permalink to this heading">#</a></h3>
<p>Next, we split each foot in <code class="docutils literal notranslate"><span class="pre">texts</span></code> into separate <em>tokens</em> (a process known as <em>tokenization</em>). In natural language processing, a token is a semantically distinct unit of text. For the purposes of this study, a token is either a <em>word token</em> consisting of any number of consecutive alphabetic characters (and possibly apostrophes) or a <em>non-word token</em> consisting of any number of punctuation marks, spaces, and other non-alphabetic characters.</p>
<p>We tokenize the text using the following function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">sonnet</span><span class="p">,</span> <span class="n">wordchars</span><span class="p">):</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sonnet</span><span class="p">)):</span>
        <span class="n">feet</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">foot</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">feet</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="n">wordchars</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">foot</span><span class="p">)</span> <span class="k">if</span> <span class="n">token</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">])</span>
        <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">feet</span>
    <span class="k">return</span> <span class="n">tokens</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">tokenize</span><span class="p">(</span><span class="n">sonnet</span><span class="p">,</span> <span class="n">nonwordchars</span><span class="p">)</span> <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The three-dimensional <code class="docutils literal notranslate"><span class="pre">texts</span></code> array has now become four-dimensional, since each foot is now a list of tokens. Each array is a list of 154 sonnets, and each sonnet is a list of 14 lines. Each line is a list of 4 or 5 feet, and each foot is a list of tokens of variable length. Note that the structure of <code class="docutils literal notranslate"><span class="pre">raw_scansions</span></code>, however, has not changed.</p>
<p>The diagram below illustrates this updated corpus structure for <code class="docutils literal notranslate"><span class="pre">texts</span></code>.</p>
<p><img alt="" src="_images/diagram_texts_tokens.png" /></p>
</section>
<section id="syllabification">
<h3><a class="toc-backref" href="#id11">Syllabification</a><a class="headerlink" href="#syllabification" title="Permalink to this heading">#</a></h3>
<p>Next, we split the word tokens apart into separate syllables using a GRU-based neural network model from the <a class="reference external" href="https://pypi.org/project/eng-syl/"><code class="docutils literal notranslate"><span class="pre">eng-syl</span></code> project</a>. The model was trained on <a class="reference external" href="https://link.springer.com/chapter/10.1007/978-3-030-78270-2_72">Wikimorph data</a> and is intended for use as an English syllabifier.</p>
<p>Although the model performs reasonably well on our sonnet corpus, it makes some obvious errors. For example, it syllabifies the word “anew” as one syllable instead of two:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">syllabifier</span><span class="o">.</span><span class="n">syllabify</span><span class="p">(</span><span class="s1">&#39;anew&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;anew&#39;
</pre></div>
</div>
</div>
</div>
<p>Many of these errors happen in cases where the model is being asked to syllabify parts of words rather than entire words. This occurs because we are syllabifying tokens rather than words, and some words have been broken up into multiple tokens (for example, because they cross foot boundaries or contain hyphens).</p>
<p>For example, the model struggles to correctly syllabify the token “ny”, which occurs as a part of words such as “many”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">syllabifier</span><span class="o">.</span><span class="n">syllabify</span><span class="p">(</span><span class="s1">&#39;ny&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;n-y&#39;
</pre></div>
</div>
</div>
</div>
<p>We can identify and correct many of these syllabification errors using the regular expressions defined below. Once again, <em>The Oxford Dictionary of Shakespearean Pronunciation</em> served as a reference for this process.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">syl_corrections</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(what)(ere)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(so)(ev)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ob)(se)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(cell)(ent)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(qui)(ty)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)(new)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(in)(her)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ist)(er)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(form)(edst)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ann)(y)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(aint)(y)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(imp)(ed)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(qui)(e)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ann)(ous)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(who)(ev)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(per)(pe)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)(cy)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(in)(ate)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(grac)(ious)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ti)(cate)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(in)(ar)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(wher)(ev)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ic)(es)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ac)(cus)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ac)(le)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)(chieve)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(fic)(es)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ic)(at)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ic)(le)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(pen)(ance)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(an)(ny)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ac)(cum)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^([ai]c)(y)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ic)(ine)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(who)(ere)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(re)(ve)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(tre)-(as)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(n)-(a)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(e)-(a)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)-(c)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ri)-(age)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(i)-(l)-(l)(a)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2\3-\4&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(n)-(y)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(u)-(t)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(re)-(as)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(tir)-(ed)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(pho)-(en)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)-(c)(quian)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(i)-(c)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(di)-(v)-(id)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)-(d)-(d)(i)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2\3-\4&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(he)-(res)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(to)-(r)-(ies)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(e)-(x)-(trem)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(be)-(lov)-(ed)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(se)-(c)-(rate)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(in)-(cre)-(as)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(a)-(di)-(eu)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(lo)-(m)-(el)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(e)-(n)-(ance)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(de)-(s)-(pis)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(ti)-(red)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(de)-(si)-(red)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1-\2\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(pe)-(t)-(u)-(al)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\2-\3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(e)-(x)(pi)-(red)$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\1\2-\3\4&#39;</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We can use the following functions to perform the actual syllabification, checking for and correcting the errors along the way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">syllabify</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">syllabifier</span><span class="p">):</span>
    <span class="c1"># syllabify token with apostrophes removed</span>
    <span class="n">syllabified</span> <span class="o">=</span> <span class="n">syllabifier</span><span class="o">.</span><span class="n">syllabify</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
    <span class="c1"># manually correct certain syllabifications</span>
    <span class="k">for</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">replacement</span> <span class="ow">in</span> <span class="n">syl_corrections</span><span class="p">:</span>
        <span class="n">syllabified</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">replacement</span><span class="p">,</span> <span class="n">syllabified</span><span class="p">)</span>
    <span class="c1"># split syllables into list</span>
    <span class="n">syllabified</span> <span class="o">=</span> <span class="n">syllabified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="c1"># use syllabified to separate the original token into syllables</span>
    <span class="n">syls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">syllabified</span><span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">syls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">[</span><span class="n">start</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">syllabified</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">syls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
    <span class="k">return</span> <span class="n">syls</span>

<span class="k">def</span> <span class="nf">syllabify_foot</span><span class="p">(</span><span class="n">foot</span><span class="p">,</span> <span class="n">syllabifier</span><span class="p">,</span> <span class="n">nonwordchars</span><span class="p">):</span>
    <span class="n">newfoot</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">foot</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">nonwordchars</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
            <span class="n">newfoot</span> <span class="o">+=</span> <span class="n">syllabify</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">syllabifier</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">newfoot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">newfoot</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">foot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
            <span class="n">line</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">syllabify_foot</span><span class="p">(</span><span class="n">foot</span><span class="p">,</span> <span class="n">syllabifier</span><span class="p">,</span> <span class="n">nonwordchars</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Each word token has now been split into separate syllables (which are each considered a word token). As a result, each foot is now a list of syllables and non-word tokens, listed in the order in which they occur in the original text.</p>
<p>The diagram below shows these changes to the corpus. Note the dimensions of <code class="docutils literal notranslate"><span class="pre">texts</span></code> have not changed; the only change is that some of the feet lists have become longer because their component word tokens have been broken up into syllables.</p>
<p><img alt="" src="_images/diagram_texts_syl.png" /></p>
</section>
<section id="scansion">
<h3><a class="toc-backref" href="#id12">Scansion</a><a class="headerlink" href="#scansion" title="Permalink to this heading">#</a></h3>
<p>The next step is to parse the raw scansion marks into a more usable and efficient form. The goal is to encode the scansion information into a form that is efficient and easy to store and analyze.</p>
<p>With this in mind, I have chosen to use <em>bitwise flags</em> to encode the scansion information. Bitwise flags are variables where each bit corresponds to a Boolean value (true or false). Because these Booleans are encoded at the bit level, this allows us to compactly store information. Additionally, we can work efficiently with these values by using <em>bitwise operations</em> that are designed to operate at the bit level.</p>
<p>For this project, we will use Python’s built-in <code class="docutils literal notranslate"><span class="pre">IntFlag</span></code> class, which allows us to define enumerated constants that can be combined into bitwise flags and have integer values. We define our <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> class as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Scansion</span><span class="p">(</span><span class="n">IntFlag</span><span class="p">):</span>
    <span class="n">UNSPEC</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># unspecified/unknown</span>
    <span class="n">SYL</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># syllable from a word token</span>
    <span class="n">STR</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># stressed syllable</span>
    <span class="c1"># flexible syllable that can be collapsed into the preceding or following syllable (treated as one or zero syllables)</span>
    <span class="n">FLEX_MINUS</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="c1"># flexible syllable that can be expanded into two syllables (can be treated as one or two syllables)</span>
    <span class="n">FLEX_PLUS</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">PUNCT</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># token that contains punctuation</span>
    <span class="n">HYPHEN</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># token that is a single hyphen</span>
    <span class="n">SPACE</span> <span class="o">=</span> <span class="mi">64</span> <span class="c1"># token that contains a space</span>
</pre></div>
</div>
</div>
</div>
<p>This class allows us to record information not only about stress but also about token type (syllabic, containing spaces, containing punctuation, etc.).</p>
<p>Note that each constant in <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> has both a name and an associated integer value. For example, <code class="docutils literal notranslate"><span class="pre">Scansion.SYL</span></code>, which represents a token that is syllabic (i.e. a word token), has the value <code class="docutils literal notranslate"><span class="pre">1</span></code>. Meanwhile, <code class="docutils literal notranslate"><span class="pre">Scansion.STR</span></code>, which represents a token that is stressed, has the value <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scansion.SYL: </span><span class="si">{</span><span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s1"> in binary)&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scansion.STR: </span><span class="si">{</span><span class="n">Scansion</span><span class="o">.</span><span class="n">STR</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">Scansion</span><span class="o">.</span><span class="n">STR</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s1"> in binary)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scansion.SYL: 1 (1 in binary)
Scansion.STR: 2 (10 in binary)
</pre></div>
</div>
</div>
</div>
<p>As the name <code class="docutils literal notranslate"><span class="pre">IntFlag</span></code> implies, we can combine these constants with bitwise operations. For example, using the bitwise operator <code class="docutils literal notranslate"><span class="pre">|</span></code>, we can combine the constants <code class="docutils literal notranslate"><span class="pre">Scansion.SYL</span></code> and <code class="docutils literal notranslate"><span class="pre">Scansion.STR</span></code> into a new <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> value that denotes that a token is both syllabic and stressed. Note how the resultant value <code class="docutils literal notranslate"><span class="pre">3</span></code> is created by combining the individual bits of the component constants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scansion.SYL | Scansion.STR: </span><span class="si">{</span><span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Scansion</span><span class="o">.</span><span class="n">STR</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="nb">bin</span><span class="p">(</span><span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Scansion</span><span class="o">.</span><span class="n">STR</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="s1"> in binary)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Scansion.SYL | Scansion.STR: 3 (11 in binary)
</pre></div>
</div>
</div>
</div>
<p>Having defined our <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> constants, we can use the following functions to parse the raw scan marks for each token and determine the corresponding <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> value.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scan_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">scanmarks</span><span class="p">,</span> <span class="n">nonwordchars</span><span class="p">):</span>
    <span class="n">scansion</span> <span class="o">=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">UNSPEC</span> <span class="c1"># unspecified value by default</span>
    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">nonwordchars</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
        <span class="c1"># token is non-syllabic</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^\w\s]&#39;</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
            <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">PUNCT</span> <span class="c1"># token contains punctuation</span>
        <span class="k">if</span> <span class="n">token</span> <span class="o">==</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
            <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">HYPHEN</span> <span class="c1"># token is a single hyphen</span>
        <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">token</span><span class="p">:</span>
            <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">SPACE</span> <span class="c1"># token contains a space</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># token is syllabic</span>
        <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span>
        <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">scanmarks</span><span class="p">:</span>
            <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">STR</span> <span class="c1"># token is stressed</span>
        <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">scanmarks</span><span class="p">:</span>
            <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">FLEX_MINUS</span> <span class="c1"># token stress belongs to flex_minus category</span>
        <span class="k">if</span> <span class="s1">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">scanmarks</span><span class="p">:</span>
            <span class="n">scansion</span> <span class="o">|=</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">FLEX_PLUS</span> <span class="c1"># token stress belongs to flex_plus category</span>
    <span class="k">return</span> <span class="n">scansion</span>

<span class="k">def</span> <span class="nf">scan_tokens</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">,</span> <span class="n">nonwordchars</span><span class="p">):</span>
    <span class="n">scansions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">sonnet</span><span class="p">,</span> <span class="n">raw_sonnetscan</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">):</span>
        <span class="n">sonnetscan</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">raw_linescan</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sonnet</span><span class="p">,</span> <span class="n">raw_sonnetscan</span><span class="p">):</span>
            <span class="n">linescan</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">foot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">footscan</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">raw_footscan</span> <span class="o">=</span> <span class="n">raw_linescan</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">foot</span><span class="p">:</span>
                    <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
                    <span class="n">footscan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scan_token</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">raw_footscan</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">],</span> <span class="n">nonwordchars</span><span class="p">))</span>
                    <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
                <span class="n">linescan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">footscan</span><span class="p">)</span>
            <span class="n">sonnetscan</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">linescan</span><span class="p">)</span>
        <span class="n">scansions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sonnetscan</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scansions</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We store our custom <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> data in the new variable <code class="docutils literal notranslate"><span class="pre">scansions</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scansions</span> <span class="o">=</span> <span class="n">scan_tokens</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">raw_scansions</span><span class="p">,</span> <span class="n">nonwordchars</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This new variable <code class="docutils literal notranslate"><span class="pre">scansions</span></code> has a four-dimensional structure identical to that of <code class="docutils literal notranslate"><span class="pre">texts</span></code>, except that the lowest level encodes <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> values instead of tokens. The diagram below illustrates what this looks like. (The values in parentheses are the numerical values of the <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> flags.)</p>
<p><img alt="" src="_images/diagram_scansion_final.png" /></p>
<p>We run a quick sanity test to make sure that every token in <code class="docutils literal notranslate"><span class="pre">text</span></code> now has corresponding information in <code class="docutils literal notranslate"><span class="pre">scansion</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># sanity test</span>
<span class="k">for</span> <span class="n">sonnet</span><span class="p">,</span> <span class="n">sonnetscan</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">scansions</span><span class="p">):</span>
    <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sonnet</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">sonnetscan</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">linescan</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sonnet</span><span class="p">,</span> <span class="n">sonnetscan</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">linescan</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">foot</span><span class="p">,</span> <span class="n">footscan</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">linescan</span><span class="p">):</span>
            <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">foot</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">footscan</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we save the parsed <code class="docutils literal notranslate"><span class="pre">texts</span></code> and <code class="docutils literal notranslate"><span class="pre">scansions</span></code> data to files called <code class="docutils literal notranslate"><span class="pre">parsed_texts.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">parsed_scansions.txt</span></code>, respectively. For convenient storage, we convert the scansion data into integers and encode both <code class="docutils literal notranslate"><span class="pre">texts</span></code> and <code class="docutils literal notranslate"><span class="pre">scansions</span></code> into the JSON format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert Scansion values into integers for storage</span>
<span class="n">scansions</span> <span class="o">=</span> <span class="p">[[[[</span>
    <span class="n">scansion</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">scansion</span> <span class="ow">in</span> <span class="n">foot</span>
<span class="p">]</span> <span class="k">for</span> <span class="n">foot</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">]</span> <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">scansions</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/parsed_texts.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">texts</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/parsed_scansions.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">scansions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="analyzing-the-corpus">
<h2><a class="toc-backref" href="#id13">Analyzing the Corpus</a><a class="headerlink" href="#analyzing-the-corpus" title="Permalink to this heading">#</a></h2>
<p>We now have a parsed corpus of Shakespeare’s sonnets with efficiently encoded scansion data that can be used for various types of automated analysis. We conclude with a few examples of the kinds of analysis that can be conducted on this corpus.</p>
<section id="setup">
<h3><a class="toc-backref" href="#id14">Setup</a><a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h3>
<p>First, we demonstrate how to read the data stored in <code class="docutils literal notranslate"><span class="pre">parsed_texts.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">parsed_scansions.txt</span></code> back into the <code class="docutils literal notranslate"><span class="pre">texts</span></code> and <code class="docutils literal notranslate"><span class="pre">scansions</span></code> variables, respectively. For the scansion data, we also convert the integers back into the <code class="docutils literal notranslate"><span class="pre">Scansion</span></code> data type for more convenient analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/parsed_texts.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">texts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;corpus/parsed_scansions.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">scansions</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    
<span class="c1"># convert scansion integer values back into Scansion values</span>
<span class="n">scansions</span> <span class="o">=</span> <span class="p">[[[[</span>
    <span class="n">Scansion</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">foot</span>
<span class="p">]</span> <span class="k">for</span> <span class="n">foot</span> <span class="ow">in</span> <span class="n">line</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">]</span> <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">scansions</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we define some variables and functions that we can use to determine the type (iamb, trochee, etc.) of each metrical foot by parsing the corresponding <code class="docutils literal notranslate"><span class="pre">scansions</span></code> data. By default, these functions automatically coerce any feet containing syllables marked as prosodically flexible into regular disyallabic feet if it is possible to do so.</p>
<p>We also define convenience functions for displaying the corpus and analysis results.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># maps patterns of stresses to foot types</span>
<span class="n">FEET</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;pyrrhic&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;iamb&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;trochee&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;spondee&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;tribrach&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;dactyl&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;amphibrach&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;anapest&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;bacchius&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;antibacchius&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;cretic&#39;</span><span class="p">,</span>
    <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="s1">&#39;molossus&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># list of all foot types</span>
<span class="n">FOOT_TYPES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;iamb&#39;</span><span class="p">,</span> <span class="s1">&#39;trochee&#39;</span><span class="p">,</span> <span class="s1">&#39;spondee&#39;</span><span class="p">,</span> <span class="s1">&#39;pyrrhic&#39;</span><span class="p">,</span> <span class="s1">&#39;cretic&#39;</span><span class="p">,</span>
       <span class="s1">&#39;unknown (4 syllables)&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown (3 syllables)&#39;</span><span class="p">,</span> <span class="s1">&#39;antibacchius&#39;</span><span class="p">,</span>
       <span class="s1">&#39;dactyl&#39;</span><span class="p">]</span>

<span class="c1"># list of all disyllabic foot types</span>
<span class="n">FOOT_TYPES_DISYL</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;iamb&#39;</span><span class="p">,</span> <span class="s1">&#39;trochee&#39;</span><span class="p">,</span> <span class="s1">&#39;spondee&#39;</span><span class="p">,</span> <span class="s1">&#39;pyrrhic&#39;</span><span class="p">]</span>

<span class="c1"># get all word tokens from a given foot</span>
<span class="k">def</span> <span class="nf">get_word_tokens</span><span class="p">(</span><span class="n">scansion</span><span class="p">,</span> <span class="n">text</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">scansion</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span> <span class="ow">in</span> <span class="n">token</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">text</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>

<span class="c1"># parse the scansion of a word token (possibly including flexible stresses)</span>
<span class="c1"># use_flex indicates whether flexible stresses should be used</span>
<span class="c1"># to coerce a short or long foot into a regular-length foot</span>
<span class="k">def</span> <span class="nf">parse_word_scansion</span><span class="p">(</span><span class="n">scansion</span><span class="p">,</span> <span class="n">use_flex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">word_tokens</span> <span class="o">=</span> <span class="n">get_word_tokens</span><span class="p">(</span><span class="n">scansion</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">word_tokens</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">use_flex</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">word_tokens</span>
    <span class="n">final_scansion</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">word_tokens</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">FLEX_MINUS</span> <span class="ow">in</span> <span class="n">token</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># decrement n by treating this token as flexible</span>
            <span class="c1"># merge this syllable with the preceding/following one by refraining from including it</span>
            <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">FLEX_PLUS</span> <span class="ow">in</span> <span class="n">token</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># increment n by treating this token as flexible</span>
                <span class="c1"># split apart this syllable into two</span>
                <span class="n">final_scansion</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Scansion</span><span class="o">.</span><span class="n">SYL</span><span class="p">)</span>
                <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">final_scansion</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_scansion</span>

<span class="c1"># classify a foot as one of the possible types (iamb, trochee, etc.)</span>
<span class="k">def</span> <span class="nf">classify_foot</span><span class="p">(</span><span class="n">scansion</span><span class="p">,</span> <span class="n">use_flex</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(((</span><span class="mi">1</span> <span class="k">if</span> <span class="n">Scansion</span><span class="o">.</span><span class="n">STR</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">parse_word_scansion</span><span class="p">(</span><span class="n">scansion</span><span class="p">,</span> <span class="n">use_flex</span><span class="p">)))</span>
    <span class="k">if</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">FEET</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">FEET</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;unknown (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="si">}</span><span class="s1"> syllables)&#39;</span>

<span class="c1"># format a p-value and indicate whether or not it is significant</span>
<span class="c1"># based on the provided sigbound (significance boundary)</span>
<span class="k">def</span> <span class="nf">display_pval</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">sigbound</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">: p-value = </span><span class="si">{</span><span class="n">pval</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="s2">&quot;not &quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">pval</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">sigbound</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="si">}</span><span class="s1">significant)&#39;</span>

<span class="k">def</span> <span class="nf">foot_to_str</span><span class="p">(</span><span class="n">foot</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">foot</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">display_sonnet</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">scansion</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">scansion</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">],</span> <span class="n">text</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
            <span class="p">[</span><span class="n">classify_foot</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">s</span><span class="p">],</span>
            <span class="p">[</span><span class="n">foot_to_str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">t</span><span class="p">],</span>
        <span class="p">])</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">tmp</span><span class="p">])</span> <span class="k">if</span> <span class="n">df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">tmp</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For example, here is the end of Sonnet 116 with annotations indicating type of each foot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">excerpt</span> <span class="o">=</span> <span class="n">display_sonnet</span><span class="p">(</span><span class="n">texts</span><span class="p">[</span><span class="mi">115</span><span class="p">],</span> <span class="n">scansions</span><span class="p">[</span><span class="mi">115</span><span class="p">],</span> <span class="n">start</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">excerpt</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <tbody>
    <tr>
      <td>SPONDEE</td>
      <td>SPONDEE</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
    </tr>
    <tr>
      <td>Love's not</td>
      <td>Time's fool,</td>
      <td>though ros</td>
      <td>y lips</td>
      <td>and cheeks</td>
    </tr>
    <tr>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
    </tr>
    <tr>
      <td>Within</td>
      <td>his bend</td>
      <td>ing sick</td>
      <td>le's comp</td>
      <td>ass come;</td>
    </tr>
    <tr>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>PYRRHIC</td>
      <td>SPONDEE</td>
      <td>IAMB</td>
    </tr>
    <tr>
      <td>Love alt</td>
      <td>ers not</td>
      <td>with his</td>
      <td>brief hours</td>
      <td>and weeks,</td>
    </tr>
    <tr>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>TROCHEE</td>
      <td>IAMB</td>
      <td>IAMB</td>
    </tr>
    <tr>
      <td>But bears</td>
      <td>it out</td>
      <td>even to</td>
      <td>the edge</td>
      <td>of doom.</td>
    </tr>
    <tr>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
    </tr>
    <tr>
      <td>If this</td>
      <td>be er</td>
      <td>ror and</td>
      <td>upon</td>
      <td>me proved,</td>
    </tr>
    <tr>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
      <td>IAMB</td>
    </tr>
    <tr>
      <td>I nev</td>
      <td>er writ,</td>
      <td>nor no</td>
      <td>man ev</td>
      <td>er loved.</td>
    </tr>
  </tbody>
</table></div></div>
</div>
<p>We are now ready to offer a few examples of what analysis of this corpus can look like.</p>
</section>
<section id="foot-types-per-index">
<h3><a class="toc-backref" href="#id15">Foot Types per Index</a><a class="headerlink" href="#foot-types-per-index" title="Permalink to this heading">#</a></h3>
<p>First, we will analyze whether there are any patterns in which types of feet appear in which indices (that is, positions) in each line. Our hypothesis is that there is a difference. For example, perhaps trochaic substitution is more likely to occur in the first foot than in the last foot of a line.</p>
<p>We begin by defining a function that will count how many of each foot type appear at each foot position in the  corpus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">count_foot_types_per_foot_index</span><span class="p">(</span><span class="n">scansions</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">FOOT_TYPES</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">scansions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">foot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">ft</span> <span class="o">=</span> <span class="n">classify_foot</span><span class="p">(</span><span class="n">foot</span><span class="p">)</span>
                <span class="n">counts</span><span class="p">[</span><span class="n">ft</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counts</span>
</pre></div>
</div>
</div>
</div>
<p>Here are the results in table form:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fc_per_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
    <span class="n">count_foot_types_per_foot_index</span><span class="p">(</span><span class="n">scansions</span><span class="p">),</span>
    <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;foot #&#39;</span><span class="p">)</span>
<span class="n">fc_per_index</span><span class="p">[</span><span class="s1">&#39;foot #&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">fc_per_index</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>foot #</th>
      <th>iamb</th>
      <th>trochee</th>
      <th>spondee</th>
      <th>pyrrhic</th>
      <th>cretic</th>
      <th>unknown (4 syllables)</th>
      <th>unknown (3 syllables)</th>
      <th>antibacchius</th>
      <th>dactyl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1736</td>
      <td>268</td>
      <td>81</td>
      <td>61</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1853</td>
      <td>29</td>
      <td>231</td>
      <td>38</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1850</td>
      <td>91</td>
      <td>95</td>
      <td>114</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1873</td>
      <td>57</td>
      <td>130</td>
      <td>85</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>1829</td>
      <td>15</td>
      <td>132</td>
      <td>18</td>
      <td>126</td>
      <td>1</td>
      <td>12</td>
      <td>6</td>
      <td>1</td>
    </tr>
  </tbody>
</table></div></div>
</div>
<p>Since the counts for foot types of more than two syllables are so low, we will restrict our analysis to the disyllabic foot types (iambs, trochees, spondees, and pyrrhics).</p>
<p>These results show that, as we hypothesized, trochees are most likely to occur in the first foot and least likely to occur in the last. Iambs, meanwhile, are most likely to occur in the fourth foot and least likely to occur in the first.</p>
<p>However, it is unclear whether any of these differences are significant. To determine this, we can use a chi-squared independence test to test whether the foot type is independent from the foot index. Our null hypothesis is that these variables are independent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pval</span> <span class="o">=</span> <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">fc_per_index</span><span class="p">[</span><span class="n">FOOT_TYPES_DISYL</span><span class="p">])</span><span class="o">.</span><span class="n">pvalue</span>
<span class="nb">print</span><span class="p">(</span><span class="n">display_pval</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span> <span class="s1">&#39;Chi-squared independence test for all disyllabic feet&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared independence test for all disyllabic feet: p-value = 0.00 (significant)
</pre></div>
</div>
</div>
</div>
<p>As we can see, we have sufficient evidence to reject the null hypothesis and conclude that the foot type depends to at least some degree on the foot index. In other words, certain types of feet are more likely to occur at certain positions in a line than at others.</p>
<p>However, is this true for all foot types, or merely for some of them? We can determine this using a chi-squared goodness-of-fit test for each foot type. For each foot type, the null hypothesis is that there is no difference between the frequencies of that foot type in each position (or, in other words, that the given foot type is equally likely to occur in one foot position as in another).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Chi-squared goodness-of-fit tests for individual foot types:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ft</span> <span class="ow">in</span> <span class="n">FOOT_TYPES_DISYL</span><span class="p">:</span>
    <span class="n">pval</span> <span class="o">=</span> <span class="n">chisquare</span><span class="p">(</span><span class="n">fc_per_index</span><span class="p">[</span><span class="n">ft</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">display_pval</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;  * For </span><span class="si">{</span><span class="n">ft</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared goodness-of-fit tests for individual foot types:
  * For iambs: p-value = 0.17 (not significant)
  * For trochees: p-value = 0.00 (significant)
  * For spondees: p-value = 0.00 (significant)
  * For pyrrhics: p-value = 0.00 (significant)
</pre></div>
</div>
</div>
</div>
<p>Based on these test results, we conclude that there is no real difference between the frequencies of iambs in different foot positions. That is, iambs are no more likely to occur in one foot position than in another.</p>
<p>However, we also conclude that there is a statistically significant difference between at least some of the frequencies of the other disyllabic foot types. In other words, trochees, spondees, and pyrrhics are more likely to occur in certain foot positions than others. This confirms our hypothesis that trochaic substitutions are more likely to occur in the first foot than, say, in the last.</p>
<p>Our observations about the data and its significance can be visually confirmed and extended using a graphical visualization. Using a bar chart, we can plot the differences between frequencies of different foot types in different foot positions:</p>
<div class="cell tag_hide-input tag_full-width docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">ft</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">FOOT_TYPES_DISYL</span><span class="p">):</span>
    <span class="n">getlegend</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">ft</span> <span class="o">==</span> <span class="n">FOOT_TYPES_DISYL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fc_per_index</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;foot #&#39;</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">ft</span><span class="p">,</span> 
        <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;foot #&#39;</span><span class="p">,</span>
        <span class="n">orient</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="n">getlegend</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">getlegend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
    <span class="c1"># modify y-limits of graph to show all labels</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ft</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">S&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Number of Foot Types per Foot Position&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">);</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;foot number&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">move_legend</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/ede5d2d2fc18a0bc6c8028acd3f3ec94726c767cc4ad783195dd8ed7f0660dee.png" src="_images/ede5d2d2fc18a0bc6c8028acd3f3ec94726c767cc4ad783195dd8ed7f0660dee.png" />
</div>
</div>
<p>This graph confirms our conclusion that the differences between iamb frequencies are not significant, whereas at least some of the differences between the trochee, spondee, and pyrrhic frequencies are significant.</p>
<p>Based on visual inspection, we can tentatively conclude the following:</p>
<ul class="simple">
<li><p>Trochees are most likely to occur in the first foot and least likely to occur in the second and fifth feet.</p></li>
<li><p>Spondees are most likely to occur in the second foot and least likely to occur in the first and third feet.</p></li>
<li><p>Pyrrhics are most likely to occur in the third foot and least likely to occur in the fifth foot.</p></li>
</ul>
</section>
<section id="irregularities-per-line-number">
<h3><a class="toc-backref" href="#id16">Irregularities per Line Number</a><a class="headerlink" href="#irregularities-per-line-number" title="Permalink to this heading">#</a></h3>
<p>Next, we will analyze whether irregularities are more likely to occur in certain lines of a sonnet than in others. For example, are the concluding lines of quatrains (lines 4, 8, and 12) more or less likely to be irregular than the other lines of those quatrains (lines 1-3, 5-7, and 9-11)?</p>
<p>Before we can determine this, however, we must determine what exactly counts as an irregularity. For the purposes of this analysis, we will define an irregular line as a line in which the proportion of iambs is smaller than some boundary proportion <span class="math notranslate nohighlight">\(b\)</span>. We use proportions rather than counts because not all of the sonnets are in pentameter (specifically, Sonnet 145 is in tetrameter).</p>
<p>First, we define functions that will enable us to count how many irregularities occur in each line position in the entire corpus. These functions will take a specific value of <span class="math notranslate nohighlight">\(b\)</span> and then calculate the counts of irregularities for each line position based on that value. (These functions also enable us to define a line that is not pentameter as irregular, but we will not be enforcing this distinction in this analysis.)</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">count_foot_types_per_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">prop</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">FOOT_TYPES</span><span class="p">}</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">foot</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="n">ft</span> <span class="o">=</span> <span class="n">classify_foot</span><span class="p">(</span><span class="n">foot</span><span class="p">)</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">ft</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># adjust counts to be proportions</span>
    <span class="k">if</span> <span class="n">prop</span><span class="p">:</span>
        <span class="n">counts</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">/</span><span class="n">n</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="k">return</span> <span class="n">counts</span>

<span class="k">def</span> <span class="nf">get_irreg_line_counts</span><span class="p">(</span><span class="n">boundary</span><span class="p">,</span> <span class="n">enforce_pentameter</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">irreg_line_counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">scansions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sonnet</span><span class="p">):</span>
            <span class="n">fp</span> <span class="o">=</span> <span class="n">count_foot_types_per_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">enforce_pentameter</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fp</span><span class="p">[</span><span class="s1">&#39;iamb&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">boundary</span><span class="p">:</span>
                <span class="n">irreg_line_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">irreg_line_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">irreg_line_counts</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">14</span><span class="p">)],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;counts&#39;</span><span class="p">])</span>
    <span class="n">irreg_line_counts</span><span class="p">[</span><span class="s1">&#39;line #&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irreg_line_counts</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">irreg_line_counts</span><span class="p">[</span><span class="s1">&#39;stanza position&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">irreg_line_counts</span><span class="o">.</span><span class="n">index</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">irreg_line_counts</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>To get an idea of how the choice of <span class="math notranslate nohighlight">\(b\)</span> affects the irregularity counts, we will compare results for four different values of <span class="math notranslate nohighlight">\(b\)</span>. These values of <span class="math notranslate nohighlight">\(b\)</span> will define an irregular line as one in which iambs make up less than <span class="math notranslate nohighlight">\(\frac{2}{5}\)</span>, <span class="math notranslate nohighlight">\(\frac{3}{5}\)</span>, <span class="math notranslate nohighlight">\(\frac{4}{5}\)</span>, and <span class="math notranslate nohighlight">\(\frac{5}{5}\)</span> of the feet in that line, respectively.</p>
<p>We then visualize the resulting counts using bar graphs. Each line number has its own bar showing the irregularity count for that position. We also color-code the bars to represent each line’s position in its stanza (first, second, third, or fourth line in a quatrain, or first or second line in a couplet).</p>
<div class="cell tag_hide-input tag_full-width docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enforce_pentameter</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">boundaries</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>

<span class="n">irreg_tables</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">boundary</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boundaries</span><span class="p">)):</span>
    <span class="n">irreg_line_counts</span> <span class="o">=</span> <span class="n">get_irreg_line_counts</span><span class="p">(</span><span class="n">boundary</span><span class="p">,</span> <span class="n">enforce_pentameter</span><span class="p">)</span>
    <span class="n">irreg_tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">irreg_line_counts</span><span class="p">)</span>
    <span class="n">getlegend</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">boundary</span> <span class="o">==</span> <span class="n">boundaries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">irreg_line_counts</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;line #&#39;</span><span class="p">,</span>
        <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;counts&#39;</span><span class="p">,</span>
        <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;stanza position&#39;</span><span class="p">,</span>
        <span class="n">legend</span><span class="o">=</span><span class="n">getlegend</span><span class="p">,</span>
    <span class="p">);</span>
    <span class="k">if</span> <span class="n">getlegend</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">containers</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar_label</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
    
    <span class="c1"># modify y-limits of graph to show all labels</span>
    <span class="n">ylim</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ylim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ylim</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ft</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">S&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Iamb Proportion &lt; </span><span class="si">{</span><span class="n">boundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1">#sns.move_legend(ax, &#39;upper left&#39;, bbox_to_anchor=(1.01, 1.01))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Number of Irregular Lines per Position&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;x-large&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;stanza position&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">move_legend</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/e0b1d08816dfec7d6b0ac542562cd1be5dae1f1dfb4075ade592a3e4ed231206.png" src="_images/e0b1d08816dfec7d6b0ac542562cd1be5dae1f1dfb4075ade592a3e4ed231206.png" />
</div>
</div>
<p>As we can see, the counts for <span class="math notranslate nohighlight">\(b = 0.4\)</span> and <span class="math notranslate nohighlight">\(b = 0.6\)</span> are very small. In other words, there are relatively few lines that fit the definition of irregularity as having a proportion of iambs less than <span class="math notranslate nohighlight">\(\frac{3}{5}\)</span>. These counts may be too small for us to conduct statistical analyses, since chi-squared tests generally require a sample size of at least 5 in each category.</p>
<p>For each value of <span class="math notranslate nohighlight">\(b\)</span>, we can check whether the sample size is too small and then run chi-squared independence and goodness-of-fit tests on the corresponding results if it is not:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">boundary</span><span class="p">,</span> <span class="n">table</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">boundaries</span><span class="p">,</span> <span class="n">irreg_tables</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Statistical Tests for Iamb Proportion &lt; </span><span class="si">{</span><span class="n">boundary</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sample_min</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;counts&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  * Min sample size: </span><span class="si">{</span><span class="n">sample_min</span><span class="si">}</span><span class="s1"> (&#39;</span> <span class="o">+</span>
          <span class="p">(</span><span class="s1">&#39;too small&#39;</span> <span class="k">if</span> <span class="n">sample_min</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="s1">&#39;large enough&#39;</span><span class="p">)</span> <span class="o">+</span>
          <span class="s1">&#39; for chi-squared tests)&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sample_min</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">display_pval</span><span class="p">(</span><span class="n">chisquare</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="s2">&quot;counts&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s1">&#39;  * Chi-squared goodness-of-fit test for counts&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">display_pval</span><span class="p">(</span>
            <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">table</span><span class="p">[[</span><span class="s2">&quot;counts&quot;</span><span class="p">,</span> <span class="s2">&quot;line #&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span>
            <span class="s1">&#39;  * Chi-squared independence test for counts and line numbers&#39;</span>
        <span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">display_pval</span><span class="p">(</span>
            <span class="n">chi2_contingency</span><span class="p">(</span><span class="n">table</span><span class="p">[[</span><span class="s2">&quot;counts&quot;</span><span class="p">,</span> <span class="s2">&quot;stanza position&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span>
            <span class="s1">&#39;  * Chi-squared independence test for counts and stanza positions&#39;</span>
        <span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Statistical Tests for Iamb Proportion &lt; 0.4
  * Min sample size: 1 (too small for chi-squared tests)

Statistical Tests for Iamb Proportion &lt; 0.6
  * Min sample size: 2 (too small for chi-squared tests)

Statistical Tests for Iamb Proportion &lt; 0.8
  * Min sample size: 22 (large enough for chi-squared tests)
  * Chi-squared goodness-of-fit test for counts: p-value = 0.03 (significant)
  * Chi-squared independence test for counts and line numbers: p-value = 0.00 (significant)
  * Chi-squared independence test for counts and stanza positions: p-value = 0.77 (not significant)

Statistical Tests for Iamb Proportion &lt; 1.0
  * Min sample size: 58 (large enough for chi-squared tests)
  * Chi-squared goodness-of-fit test for counts: p-value = 0.53 (not significant)
  * Chi-squared independence test for counts and line numbers: p-value = 0.01 (significant)
  * Chi-squared independence test for counts and stanza positions: p-value = 0.89 (not significant)
</pre></div>
</div>
</div>
</div>
<p>As we suspected, the counts for <span class="math notranslate nohighlight">\(b = 0.4\)</span> and <span class="math notranslate nohighlight">\(b = 0.6\)</span> are too small for chi-squared tests. However, the counts for <span class="math notranslate nohighlight">\(b = 0.8\)</span> and <span class="math notranslate nohighlight">\(b = 1\)</span> are large enough, so we were able to run the tests for those values of <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>When we define irregularity as having a proportion of iambs less than $\frac{4}/{5}, we find that the differences between counts are statistically significant. We also find that the irregularity counts and line numbers are not independent (though we lack sufficient evidence to conclude that the irregularity counts and stanza positions are also not independent). As a result, we can conclude that some lines in a sonnet are significantly more likely to be irregular than others.</p>
<p>When we define irregularity as any line with a foot type other than an iamb (<span class="math notranslate nohighlight">\(b = 1\)</span>), however, we are much more limited in what we can conclude. This is likely because the counts for the different line numbers are so similar to each other. All that we can conclude is that the irregularity counts are not independent of the line positions.</p>
<p>Based on visual inspection of the graph for <span class="math notranslate nohighlight">\(b = 0.8\)</span>, we can make a few tentative observations (keeping in mind that the observed differences may not all be significant):</p>
<ul class="simple">
<li><p>The second and third lines of the quatrains are relatively less likely to be irregular.</p></li>
<li><p>The last lines of the first and second quatrains are relatively likely to be irregular, but the last line of the third quatrain is not. Perhaps this is because the first line of the third quatrain is also relatively likely to be irregular.</p></li>
<li><p>The last line of the concluding couplet is more likely to be irregular than the first line of the couplet.</p></li>
</ul>
</section>
<section id="consecutive-feet">
<h3><a class="toc-backref" href="#id17">Consecutive Feet</a><a class="headerlink" href="#consecutive-feet" title="Permalink to this heading">#</a></h3>
<p>Finally, we will analyze whether certain pairs of consecutive foot types are more likely to occur than others. For example, is a trochee more likely to be followed by an iamb or a spondee? Given the relatively low counts of feet longer than two syllables, we limit our analysis once again to the disyllabic foot types.</p>
<p>For all foot types <span class="math notranslate nohighlight">\(x, y\)</span> in the set of disyllabic foot types, we count the number of occurrences of the pair <span class="math notranslate nohighlight">\((x, y)\)</span> in the corpus. (Note that <span class="math notranslate nohighlight">\(x\)</span> can be equal to <span class="math notranslate nohighlight">\(y\)</span>.) The results are shown in the table below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">feet_types</span> <span class="o">=</span> <span class="n">FOOT_TYPES_DISYL</span>
<span class="n">indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">feet_types</span><span class="p">)}</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

<span class="n">consec_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
<span class="k">for</span> <span class="n">sonnet</span> <span class="ow">in</span> <span class="n">scansions</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">sonnet</span><span class="p">:</span>
        <span class="n">current_ft</span> <span class="o">=</span> <span class="n">classify_foot</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">next_ft</span> <span class="o">=</span> <span class="n">classify_foot</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">current_ft</span> <span class="ow">in</span> <span class="n">indices</span> <span class="ow">and</span> <span class="n">next_ft</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                <span class="n">consec_counts</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">current_ft</span><span class="p">]][</span><span class="n">indices</span><span class="p">[</span><span class="n">next_ft</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">current_ft</span> <span class="o">=</span> <span class="n">next_ft</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">consec_counts</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">feet_types</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">feet_types</span><span class="p">)</span>
<span class="n">cc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>iamb</th>
      <th>trochee</th>
      <th>spondee</th>
      <th>pyrrhic</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>iamb</th>
      <td>6540.0</td>
      <td>113.0</td>
      <td>341.0</td>
      <td>169.0</td>
    </tr>
    <tr>
      <th>trochee</th>
      <td>353.0</td>
      <td>42.0</td>
      <td>39.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>spondee</th>
      <td>386.0</td>
      <td>28.0</td>
      <td>36.0</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>pyrrhic</th>
      <td>107.0</td>
      <td>6.0</td>
      <td>171.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use a chi-squared independence test to determine whether these results are statistically significant:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">display_pval</span><span class="p">(</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="s1">&#39;P-value for chi-squared independence test&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>P-value for chi-squared independence test: p-value = 0.00 (significant)
</pre></div>
</div>
</div>
</div>
<p>We conclude that the types of the first and second feet in the pairs are not independent. In other words, the type of a given foot depends at least in part on the type of the preceding foot.</p>
<p>We can also visualize the counts of foot type pairs using a heatmap:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">.15</span><span class="p">,</span> <span class="mf">.04</span><span class="p">,</span> <span class="mf">.68</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.0f&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cbar_ax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">);</span>

<span class="c1"># set custom vmax label in colormap legend</span>
<span class="c1"># (based on answer by mburke05 at https://stackoverflow.com/a/37054853, CC BY-SA 3.0 license)</span>
<span class="n">original_labels</span> <span class="o">=</span> <span class="n">cbar_ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">original_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">original_labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="si">}</span><span class="s1">+&#39;</span><span class="p">]</span>
<span class="n">cbar_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">cbar_ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]);</span>
<span class="n">cbar_ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/ede7ee2e1f9c72d76ecb2f54e38e5f4131a2185496a75fbe5d6b0c77617cfc0f.png" src="_images/ede7ee2e1f9c72d76ecb2f54e38e5f4131a2185496a75fbe5d6b0c77617cfc0f.png" />
</div>
</div>
<p>Based on visual analysis of this heatmap, we can make an interesting observation about the relationship between pyrrhics and other feet. As expected, consecutive feet are far and away most likely to consist of a pair of iambs. Since iambs are the most common foot type, they are the most likely to be the first element of a pair with any other disyllabic foot type. They are also the most likely to be the second element of a pair following a trochee or a spondee. However, they are only second most likely to follow pyrrhics, trailing slightly behind spondees (with 171 (<code class="docutils literal notranslate"><span class="pre">pyrrhic</span></code>, <code class="docutils literal notranslate"><span class="pre">spondee</span></code>) pairs compared to only 107 (<code class="docutils literal notranslate"><span class="pre">pyrrhic</span></code>, <code class="docutils literal notranslate"><span class="pre">iamb</span></code>) pairs). Perhaps this indicates a pattern in English prosody where a pair of unstressed syllables tends to be followed by a pair of stressed syllables.</p>
</section>
</section>
<section id="conclusion">
<h2><a class="toc-backref" href="#id18">Conclusion</a><a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>This project has offered a case study of how the corpus of Shakespeare’s sonnets can be prepared and parsed into a form that allows for various forms of computationally aided analysis. In doing so, this project has offered both theoretical ideas and practical implementations for how to annotate, encode, and investigate poetic corpora.</p>
<p>Through the process of correcting the corpus, I have identified and grappled with various problems such as how to map a prosodic theory onto an actual text, how to standardize scansion marks, and how to handle cases of prosodic flexibility. Through the process of parsing and scanning the corpus, I have learned how to structure and operate on the text and scansion data while prioritizing both efficiency and comprehensibility. Finally, through the process of analyzing the corpus, I have gained insights into the ways that knowledge of poetry paired with computational techniques can reveal intriguing patterns in prosody.</p>
<p>This project has raised many interesting questions and made many intriguing observations about Shakespeare’s sonnets. Nevertheless, further work is needed to fully explore the possibilities of this sort of computational analysis. For example, the scansion data used in this report includes information about punctuation, yet my analysis did not take this into account. Future research could remedy this omission by investigating questions about how punctuation affects prosodic patterns in poetry. As another example, this report considers Shakespeare’s sonnets in isolation rather than situating them in their wider context. It would be interesting to compare patterns in Shakespeare’s sonnets to patterns in other sonnet sequences such as Sir Philip Sidney’s <em>Astrophil and Stella</em> or Edmund Spenser’s <em>Amoretti</em>.</p>
<p>Parts of the process detailed in this report, such as the manual correction of the corpus, may not be easily generalizable to other contexts, since they were tailored so closely to the unique problems presented by this particular corpus. However, some of the other sections of this report may provide valuable ideas and implementations for how to conduct computational analyses on other poetic corpora. In particular, it is my hope that my suggestions regarding the structure and encoding of both text and scansion data may prove useful for other projects.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scraping-the-corpus">Scraping the Corpus</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correcting-the-corpus">Correcting the Corpus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#manual-correction">Manual Correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automatic-correction">Automatic Correction</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parsing-and-scanning-the-corpus">Parsing and Scanning the Corpus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#division-into-metrical-feet">Division into Metrical Feet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tokenization">Tokenization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syllabification">Syllabification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scansion">Scansion</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analyzing-the-corpus">Analyzing the Corpus</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#foot-types-per-index">Foot Types per Index</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#irregularities-per-line-number">Irregularities per Line Number</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#consecutive-feet">Consecutive Feet</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Claire Wagner
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright Spring 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>